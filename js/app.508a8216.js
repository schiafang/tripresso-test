(function(t){function e(e){for(var a,o,i=e[0],c=e[1],u=e[2],p=0,f=[];p<i.length;p++)o=i[p],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&f.push(s[o][0]),s[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);l&&l(e);while(f.length)f.shift()();return n.push.apply(n,u||[]),r()}function r(){for(var t,e=0;e<n.length;e++){for(var r=n[e],a=!0,i=1;i<r.length;i++){var c=r[i];0!==s[c]&&(a=!1)}a&&(n.splice(e--,1),t=o(o.s=r[0]))}return t}var a={},s={app:0},n=[];function o(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=a,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(r,a,function(e){return t[e]}.bind(null,a));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/tripresso-test/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var u=0;u<i.length;u++)e(i[u]);var l=c;n.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"034f":function(t,e,r){"use strict";var a=r("85ec"),s=r.n(a);s.a},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("Navtab"),r("router-view")],1)},n=[],o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("nav",{staticClass:"navtab"},[r("router-link",{attrs:{to:"/search"}},[r("span",{staticClass:"item"},[t._v("團體旅遊")])])],1)},i=[],c=(r("ef50"),r("2877")),u={},l=Object(c["a"])(u,o,i,!1,null,"dea58cac",null),p=l.exports,f={name:"App",components:{Navtab:p}},d=f,g=(r("034f"),Object(c["a"])(d,s,n,!1,null,null,null)),v=g.exports,h=r("8c4f"),_=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"search"},[r("div",{staticClass:"banner"},[r("img",{staticClass:"banner-image",attrs:{src:t.bannerImage,alt:"search-page-banner"}})]),r("div",{staticClass:"search-content"},[r("div",{staticClass:"search-info"},[r("span",{staticClass:"title"},[t._v("團體旅遊")]),r("span",{staticClass:"info"},[t._v(t._s(t.totalTours))]),t._v(" 個行程 ，平均團費 "),r("span",{staticClass:"info"},[t._v(t._s(t._f("price")(t.averagePrice))+" ")]),t._v(" 元 ")]),r("div",{staticClass:"sort-tab"},[r("span",[t._v(" 排序 ")]),r("button",{class:["sort-item",{active:""===t.sortBy||"rating_desc"===t.sortBy}],on:{click:t.sortByRating}},[t._v(" 精選評分 ")]),r("div",{class:["sort-item","price-dropdown",{active:"price_asc"===t.sortBy||"price_desc"===t.sortBy}]},[r("span",{staticClass:"price-label"},[t._v(t._s(t._f("sortTag")(t.sortBy)))]),t.priceDropdownToggle?r("div",{staticClass:"dropdown-content"},[r("button",{staticClass:"dropdown-item",on:{click:function(e){return t.sortByPrice("price_asc")}}},[t._v(" 價格 低-高 ")]),r("button",{staticClass:"dropdown-item",on:{click:function(e){return t.sortByPrice("price_desc")}}},[t._v(" 價格 高-低 ")])]):t._e()]),r("button",{staticClass:"sort-item",attrs:{disabled:""}},[t._v(" 天數 ")]),r("button",{staticClass:"sort-item",attrs:{disabled:""}},[t._v(" 出發日期 ")])]),r("TourCard",{attrs:{tours:t.tours}}),r("div",{staticClass:"pagination"},[r("button",{staticClass:"prev page",attrs:{disabled:1===t.pageNow},on:{click:t.prevPage}},[r("i",{staticClass:"fas fa-chevron-left"})]),t._l(t.pages,(function(e,a){return r("router-link",{key:a,staticClass:"page-link",attrs:{to:{name:"Search",query:{page:e,sort:t.sortBy}}}},[r("span",{staticClass:"page",class:{active:t.pageNow===e}},[t._v(" "+t._s(e)+" ")])])})),r("button",{staticClass:"next page",attrs:{disabled:t.pageNow===t.pages[t.pages.length-1]},on:{click:t.nextPage}},[r("i",{staticClass:"fas fa-chevron-right"})])],2)],1)])},b=[],y=(r("99af"),r("4160"),r("a630"),r("caad"),r("a15b"),r("a9e3"),r("d3b7"),r("ac1f"),r("25f0"),r("2532"),r("3ca3"),r("1276"),r("159b"),r("96cf"),r("1da1")),m=r("bc3a"),C=r.n(m),w=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",t._l(t.tours,(function(e){return r("div",{key:e.id,staticClass:"tour-card"},[r("div",{staticClass:"tour-card-image-wrapper"},[r("a",{attrs:{href:e.tour_detail_url,target:"_blank"}},[r("img",{staticClass:"tour-card-image",attrs:{src:e.image_url,alt:"tour-card-image"}})])]),r("div",{staticClass:"tour-card-info"},[r("a",{attrs:{href:e.tour_detail_url,target:"_blank"}},[r("div",{staticClass:"card-top"},[r("div",{staticClass:"agency-rating"},[r("span",{staticClass:"agency"},[t._v(" "+t._s(e.agency))]),t._l(e.rating,(function(t,e){return r("i",{key:e,staticClass:"fas fa-star"})}))],2),r("i",{staticClass:"far fa-heart"})]),r("div",{staticClass:"tour-title"},[t._v(" "+t._s(e.title)+" ")]),r("div",{staticClass:"tour-tags"},t._l(e.tags,(function(e,a){return r("span",{key:a,staticClass:"tag"},[t._v(" "+t._s(e)+" ")])})),0)])]),r("div",{staticClass:"card-bottom"},[r("div",{staticClass:"tour-dates"},[t._l(e.group.slice(0,4),(function(e){return r("div",{key:e.id,staticClass:"group"},[r("span",{staticClass:"date"},[t._v(t._s(t._f("groupDate")(e.date)))]),r("span",{staticClass:"left"},[t._v("可售 "+t._s(e.quantity)+" 位")])])})),r("span",{staticClass:"group"},[t._v("更多日期")])],2),r("div",{staticClass:"tour-day-price"},[r("span",[t._v(t._s(e.tour_days))]),t._v(" 天 "),r("span",[t._v(t._s(t._f("price")(e.min_price)))]),t._v(" 元起 ")])])])})),0)},T=[],k=(r("fb6a"),r("5319"),{name:"TourCard",props:{tours:{type:Array,required:!0}},mounted:function(){console.log(this.tours)},filters:{groupDate:function(t){return t.slice(5,10).replace("-","/")},price:function(t){function e(t){var e=[],r=0;t=(t||0).toString().split("");for(var a=t.length-1;a>=0;a--)r++,e.unshift(t[a]),r%3||0===a||e.unshift(",");return e.join("")}return e(t)}}}),x=k,q=(r("9e4b"),Object(c["a"])(x,w,T,!1,null,"73b7d6b3",null)),$=q.exports,j="https://dszfbyatv8d2t.cloudfront.net/curatorial/twtrip/sr_4000x520_x05.jpg",P="https://interview.tripresso.com/tour/search",B={name:"Search",components:{TourCard:$},data:function(){return{pages:[],tours:[],sortBy:"",averagePrice:0,totalTours:0,priceDropdownToggle:!1,active:!0,bannerImage:j,pageNow:null}},created:function(){var t=this.$route.query.page,e=this.$route.query.sort;this.sortBy=e,this.pageNow=t?Number(t):1,this.fetchTours(t,e)},watch:{$route:function(t){this.fetchTours(t.query.page,t.query.sort),this.pageNow=Number(t.query.page)}},mounted:function(){var t=this;document.addEventListener("click",(function(e){var r=e.target.className;r.includes("price-dropdown")||r.includes("price-label")?t.priceDropdownToggle=!t.priceDropdownToggle:r.includes("dropdown-content")||(t.priceDropdownToggle=!1)}))},methods:{fetchTours:function(t,e){var r=this;return Object(y["a"])(regeneratorRuntime.mark((function a(){var s,n,o,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(e="rating_desc",r.sortBy="rating_desc"),a.prev=1,a.next=4,C.a.get("".concat(P,"?page=").concat(t,"&row_per_page=10&sort=").concat(e));case 4:return s=a.sent,r.tours=s.data.data.tour_list,a.next=8,C.a.get("".concat(P,"?row_per_page=1000000"));case 8:n=a.sent,o=n.data.data.tour_list,i=0,o.forEach((function(t){return i+=Number(t.min_price)})),r.totalTours=o.length,r.averagePrice=Math.floor(i/o.length),r.pages=Array.from({length:o.length/10},(function(t,e){return e+1})),a.next=20;break;case 17:a.prev=17,a.t0=a["catch"](1),console.error(a.t0);case 20:case"end":return a.stop()}}),a,null,[[1,17]])})))()},sortByRating:function(){var t=this.$route.query.sort;this.sortBy="rating_desc","rating_desc"!==t&&this.$router.push({name:"Search",query:{sort:"rating_desc"}})},sortByPrice:function(t){var e=this.$route.query.sort;e!==t&&(this.sortBy=t,this.$router.push({name:"Search",query:{sort:t}}))},dropdownToggle:function(){this.priceDropdownToggle=!this.priceDropdownToggle},prevPage:function(){var t=this.$route.query.sort,e=Number(this.$route.query.page);this.$router.push({name:"Search",query:{page:e-1,sort:t}})},nextPage:function(){var t=this.$route.query.sort,e=Number(this.$route.query.page);this.$router.push({name:"Search",query:{page:e+1,sort:t}})}},filters:{price:function(t){function e(t){var e=[],r=0;t=(t||0).toString().split("");for(var a=t.length-1;a>=0;a--)r++,e.unshift(t[a]),r%3||0===a||e.unshift(",");return e.join("")}return e(t)},sortTag:function(t){return""===t||"rating_desc"===t?"價格":"price_asc"===t?"價格 低-高":"價格 高-低"}}},O=B,N=(r("eea2"),Object(c["a"])(O,_,b,!1,null,"0f15d4bb",null)),S=N.exports;a["a"].use(h["a"]);var D=[{path:"/search",name:"Search",component:S}],E=new h["a"]({mode:"hash",base:"/tripresso-test/",routes:D}),M=E;a["a"].config.productionTip=!1,new a["a"]({router:M,render:function(t){return t(v)}}).$mount("#app")},"786f":function(t,e,r){},"85ec":function(t,e,r){},"9e4b":function(t,e,r){"use strict";var a=r("a28b"),s=r.n(a);s.a},a28b:function(t,e,r){},c374:function(t,e,r){},eea2:function(t,e,r){"use strict";var a=r("786f"),s=r.n(a);s.a},ef50:function(t,e,r){"use strict";var a=r("c374"),s=r.n(a);s.a}});
//# sourceMappingURL=app.508a8216.js.map